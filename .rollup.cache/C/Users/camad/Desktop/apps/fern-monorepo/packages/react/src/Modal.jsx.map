{"version":3,"file":"Modal.jsx","sourceRoot":"","sources":["Modal.tsx"],"names":[],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from 'react'\r\nimport { cn, useListener } from './_util'\r\n\r\ninterface Props {\r\n  innerRef?: any\r\n  id?: string\r\n  wrapperClass?: string\r\n  children?: any\r\n  className?: string\r\n  style?: object\r\n  onAction?: Function\r\n  bgClass?: string\r\n  transition?: string\r\n  openDelay?: number\r\n  closeDelay?: number\r\n  relative?: boolean\r\n  exitOn?: { bg?: true, click?: false, escape?: true }\r\n  scrollLock?: boolean\r\n  focus?: boolean\r\n}\r\n\r\nexport default function Modal({\r\n  innerRef,\r\n  id,\r\n  wrapperClass,\r\n  children,\r\n  className,\r\n  style,\r\n  onAction,\r\n  bgClass,\r\n  transition = 'modal',\r\n  openDelay = 0,\r\n  closeDelay = 0,\r\n  relative = false,\r\n  exitOn = { bg: true, click: false, escape: true },\r\n  scrollLock = false,\r\n  focus = false\r\n}: Props) {\r\n  const [active, setActive] = useState<boolean | any>(null)\r\n  const wrapperRef = innerRef || useRef()\r\n  const timer = useRef<any>()\r\n\r\n  const setModalTimer = (willBeActive: boolean, delay: number) =>\r\n    timer.current = setTimeout(() => setModalActive(willBeActive), delay)\r\n\r\n  const setModalActive = (willBeActive: boolean) => {\r\n    clearTimeout(timer.current)\r\n    setActive(willBeActive)\r\n\r\n    if (scrollLock)\r\n      document.body.style.overflow = willBeActive ? 'hidden' : 'auto'\r\n\r\n    if (!willBeActive)\r\n      return\r\n\r\n    if (focus)\r\n      setTimeout(() => wrapperRef.current.querySelector('[tabindex=\"0\"] [tabindex=\"1\"]')?.focus(), 50)\r\n      \r\n    if (closeDelay > 0)\r\n      setModalTimer(false, closeDelay)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (openDelay > 0)\r\n      setModalTimer(true, openDelay)\r\n  }, [])\r\n\r\n  useListener('keydown', (e: any) => {\r\n    if (active && !e.repeat && exitOn?.escape && e?.key?.toLowerCase() === 'escape')\r\n      setModalActive(false)\r\n  })\r\n\r\n  useListener('mouseup', (e: any) => {\r\n    if (active && exitOn?.click && !wrapperRef.current.lastChild.contains(e.target))\r\n      setTimeout(() => setModalActive(false), 0)\r\n  })\r\n\r\n  useListener('FernModalAction', (e: any) => {\r\n    const action = e.detail.action\r\n    setModalActive(action < 2 ? action : !active)\r\n    onAction && onAction(e)\r\n  }, wrapperRef)\r\n\r\n  return (\r\n    <span\r\n      ref={wrapperRef}\r\n      id={id}\r\n      className={cn('fui-listener', wrapperClass)}\r\n      style={wrapperStyle(relative) as Object}\r\n    >\r\n      <div\r\n        className={cn('fui-modal-bg', transition + '-bg-' + (active ? 'open' : 'close'), bgClass)}\r\n        onClick={() => exitOn?.bg && setModalActive(false)}\r\n        aria-hidden={!active}\r\n        style={bgStyle(relative) as Object}\r\n      />\r\n\r\n      <div\r\n        className={cn('fui-modal', transition + '-' + (active ? 'open' : 'close'), className)}\r\n        aria-hidden={!active}\r\n        style={{ ...menuStyle(relative, active), ...style } as Object}\r\n      >\r\n        {children}\r\n      </div>\r\n    </span>\r\n  )\r\n}\r\n\r\nconst wrapperStyle = (relative: boolean) => ({\r\n  position: relative ? 'relative' : 'absolute',\r\n  display: relative ? 'block' : 'initial',\r\n})\r\n\r\nconst bgStyle = (relative: boolean) => ({\r\n  position: 'fixed',\r\n  top: '-50%',\r\n  bottom: '-50%',\r\n  left: '-50%',\r\n  right: '-50%',\r\n  zIndex: relative ? '30' : '50',\r\n})\r\n\r\nconst menuStyle = (relative: boolean, active: boolean | null) => ({\r\n  overflowY: 'auto',\r\n  zIndex: relative ? '31' : '51',\r\n  position: relative ? 'absolute' : 'fixed',\r\n  visibility: active === null && 'hidden !important',\r\n})"]}